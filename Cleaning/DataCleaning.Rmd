---
title: "Happiness_Project"
author: "Emma Horton"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Libraries

```{r}
library(dplyr)
```


Read in Dataset

```{r}
getwd()
df <- read.csv("WorldHappinessReport.csv")
View(df)

```

View Head
```{r}
head(df)
```

Handle Missing
```{r}
summary(df)
```
Cleaning Data for Regional Indicator

```{r}
df[df$Regional.Indicator == "", ]
```

Missing Regions Replacement
```{r}
 df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Angola',
                           Regional.Indicator,
                           "Southern Africa"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Belize',
                           Regional.Indicator,
                           "Central America"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Bhutan',
                           Regional.Indicator,
                           "South Asia"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Central African Republic',
                           Regional.Indicator,
                           "Cenral Africa"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Congo (Kinshasa)',
                           Regional.Indicator,
                           "Cenral Africa"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Cuba',
                           Regional.Indicator,
                           "Caribbean"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Czechia',
                           Regional.Indicator,
                           "Central Europe"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Djibouti',
                           Regional.Indicator,
                           "East Africa"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Eswatini',
                           Regional.Indicator,
                           "South Africa"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Guyana',
                           Regional.Indicator,
                           "Anglophone Caribbean"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Oman',
                           Regional.Indicator,
                           "Middle East"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Qatar',
                           Regional.Indicator,
                           "Middle East"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Somalia',
                           Regional.Indicator,
                           "East Africa"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Somaliland region',
                           Regional.Indicator,
                           "East Africa"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'South Sudan',
                           Regional.Indicator,
                           "North Africa"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Sudan',
                           Regional.Indicator,
                           "North Africa"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Suriname',
                           Regional.Indicator,
                           "South America"))

df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Syria',
                           Regional.Indicator,
                           "Middle East"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Trinidad and Tobago',
                           Regional.Indicator,
                           "Caribbean"))
df %>%
  mutate(Regional.Indicator = ifelse(is.na(Regional.Indicator) & Country.Name == 'Turkiye',
                           Regional.Indicator,
                           "Central and Eastern Europe"))



```


Cleaning Data Median Values for Numeric Variables

```{r}
cleaning <- df

cleaning$Log.GDP.Per.Capita <- ifelse(is.na(cleaning$Log.GDP.Per.Capita),                           median(cleaning$Log.GDP.Per.Capita,
          na.rm = TRUE),
        cleaning$Log.GDP.Per.Capita)

cleaning$Social.Support <- ifelse(is.na(cleaning$Social.Support),
                                  median(cleaning$Social.Support,
                                  na.rm = TRUE),
                          cleaning$Social.Support)
cleaning$Social.Support <- ifelse(is.na(cleaning$Social.Support),
                                  median(cleaning$Social.Support,
                                  na.rm = TRUE),
                          cleaning$Social.Support)
cleaning$Healthy.Life.Expectancy.At.Birth <- ifelse(is.na(cleaning$Healthy.Life.Expectancy.At.Birth),             
                                                    median(cleaning$Healthy.Life.Expectancy.At.Birth,
                                                           na.rm = TRUE),
                                                    cleaning$Healthy.Life.Expectancy.At.Birth)
cleaning$Freedom.To.Make.Life.Choices <- ifelse(is.na(cleaning$Freedom.To.Make.Life.Choices),                   
                                                median(cleaning$Freedom.To.Make.Life.Choices,
                                                       na.rm = TRUE),
                                                cleaning$Freedom.To.Make.Life.Choices)
cleaning$Generosity <- ifelse(is.na(cleaning$Generosity),                           
                              median(cleaning$Generosity,
                                  na.rm = TRUE),
                          cleaning$Generosity)
cleaning$Perceptions.Of.Corruption <- ifelse(is.na(cleaning$Perceptions.Of.Corruption),                           
                              median(cleaning$Perceptions.Of.Corruption,
                                  na.rm = TRUE),
                          cleaning$Perceptions.Of.Corruption)
cleaning$Positive.Affect <- ifelse(is.na(cleaning$Positive.Affect),                           
                              median(cleaning$Positive.Affect,
                                  na.rm = TRUE),
                          cleaning$Positive.Affect)
cleaning$Negative.Affect <- ifelse(is.na(cleaning$Negative.Affect),                           
                              median(cleaning$Negative.Affect,
                                  na.rm = TRUE),
                          cleaning$Negative.Affect)
cleaning$Confidence.In.National.Government <- ifelse(is.na(cleaning$Confidence.In.National.Government),                 
                              median(cleaning$Confidence.In.National.Government,
                                  na.rm = TRUE),
                          cleaning$Confidence.In.National.Government)
 
summary(cleaning)
```

Outlier Detection on Life Ladder

```{r}
summary(cleaning)
boxplot(Life.Ladder ~ Regional.Indicator, data = cleaning,
        main = "Life Ladder Distribution by Region",
        xlab = "Region", ylab = "Life Ladder")

```
Outlier Detection on Log.GDP.Per.Capita
```{r}
summary(cleaning)
boxplot(Log.GDP.Per.Capita ~ Regional.Indicator, data = cleaning,
        main = "Log.GDP.Per.Capita Distribution by Region",
        xlab = "Region", ylab = "Log.GDP.Per.Capita")
```

Outlier Detection on Social Support
```{r}
summary(cleaning)
boxplot(Social.Support ~ Regional.Indicator, data = cleaning,
        main = "Social Support Distribution by Region",
        xlab = "Region", ylab = "Social Support")
```
Outlier Detection on Healthy Life Expectancy

```{r}
summary(cleaning)
boxplot(Healthy.Life.Expectancy.At.Birth ~ Regional.Indicator, data = cleaning,
        main = "Healthy Life Expectancy Distribution by Region",
        xlab = "Region", ylab = "Healthy Life Expectancy")
```


Outlier Detection on Freedom.To.Make.Life.Choices

```{r}
summary(cleaning)
boxplot(Freedom.To.Make.Life.Choices ~ Regional.Indicator, data = cleaning,
        main = "Freedom in Life Choice Distribution by Region",
        xlab = "Region", ylab = "Freedom in Life Choice")
```

Outlier Detection on Generosity


```{r}
summary(cleaning)
boxplot(Generosity ~ Regional.Indicator, data = cleaning,
        main = "Generosity Distribution by Region",
        xlab = "Region", ylab = "Generosity")
```


Outlier Detection on Corruption Perception
```{r}
summary(cleaning)
boxplot(Perceptions.Of.Corruption ~ Regional.Indicator, data = cleaning,
        main = "Perception of Corruption Distribution by Region",
        xlab = "Region", ylab = "Perception of Corruption")
```


Outlier Detection on Positive Affect by Region
```{r}
summary(cleaning)
boxplot(Positive.Affect ~ Regional.Indicator, data = cleaning,
        main = "Positive.Affect Distribution by Region",
        xlab = "Region", ylab = "Positive.Affect")
```


Outlier Detection on Negative Effect
```{r}
summary(cleaning)
boxplot(Negative.Affect ~ Regional.Indicator, data = cleaning,
        main = "Negative Effect Distribution by Region",
        xlab = "Region", ylab = "Negative Effect")
```

```{r}
unique(cleaning$Regional.Indicator)
```
Save DataFrame in a Pretty Name
```{r}
cleaning -> happydf
```





Export Data to CSV
```{r}

write.csv(cleaning,"/Users/emmahorton/DataScience/DataMunging/Project2/HappyDataFrame", row.names=FALSE)
```




